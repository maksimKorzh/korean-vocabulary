
<!DOCTYPE html>

<html>
  <head>
    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <!-- Bootstrap -->
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script type = "text/javascript"  src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script type = "text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script type = "text/javascript"  src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>

    <!-- Datatable -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.dataTables.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
    <script type = "text/javascript"  src="https://cdn.datatables.net/plug-ins/1.10.15/dataRender/datetime.js"></script>
    
    <!-- Analytics -->
    <script type="text/javascript">
      if (window.location.href.includes('github')) {
        $.post('https://maksimkorzh.pythonanywhere.com/analytics/api/post', {
          date: new Date,
          url: window.location.href
        });
      }
    </script>

  </head>
  <body>
    <div class="card">
      <div class="card-header text-center">
        <h5 class="font-weight-bold">Auto generated vocabulary</h5>
        <small>Made with ❤ by Code Monkey King</small>
      </div>
      <div class="card-body">
        <div class="row m-0 p-0">
          <div class="col m-0 p-0" style="width: 730px;">
            <table id="vocabulary" class="display table nowrap responsive" style="width: 100%">
              <thead>
                <tr>
                  
                    <th>Word</th>
                  
                    <th>Type</th>
                  
                    <th>Translation</th>
                  
                    <th>Present tense</th>
                  
                    <th>Past tense</th>
                  
                    <th>Future tense</th>
                  
                </tr>
              </thead>
              <tbody>
                
                  <tr>
                    
                      <td>내일</td>
                    
                      <td>Noun</td>
                    
                      <td>tomorrow</td>
                    
                      <td></td>
                    
                      <td></td>
                    
                      <td></td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>은</td>
                    
                      <td>Josa</td>
                    
                      <td>Eun</td>
                    
                      <td></td>
                    
                      <td></td>
                    
                      <td></td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>오늘</td>
                    
                      <td>Noun</td>
                    
                      <td>today</td>
                    
                      <td></td>
                    
                      <td></td>
                    
                      <td></td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>보다</td>
                    
                      <td>Josa</td>
                    
                      <td>see</td>
                    
                      <td></td>
                    
                      <td></td>
                    
                      <td></td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>추워지다</td>
                    
                      <td>Verb</td>
                    
                      <td>It gets cold</td>
                    
                      <td>추워져요</td>
                    
                      <td>추워졌어요</td>
                    
                      <td>추워질 거예요</td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>수도</td>
                    
                      <td>Noun</td>
                    
                      <td>capital city</td>
                    
                      <td></td>
                    
                      <td></td>
                    
                      <td></td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>있다</td>
                    
                      <td>Adjective</td>
                    
                      <td>There is</td>
                    
                      <td>있어요</td>
                    
                      <td>있었어요</td>
                    
                      <td>있을 거예요</td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>옷</td>
                    
                      <td>Noun</td>
                    
                      <td>outfit</td>
                    
                      <td></td>
                    
                      <td></td>
                    
                      <td></td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>을</td>
                    
                      <td>Josa</td>
                    
                      <td>a</td>
                    
                      <td></td>
                    
                      <td></td>
                    
                      <td></td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>따뜻하다</td>
                    
                      <td>Adjective</td>
                    
                      <td>warm</td>
                    
                      <td>따뜻해요</td>
                    
                      <td>따뜻했어요</td>
                    
                      <td>따뜻할 거예요</td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>입다</td>
                    
                      <td>Verb</td>
                    
                      <td>wear</td>
                    
                      <td>입어요</td>
                    
                      <td>입었어요</td>
                    
                      <td>입을 거예요</td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>되다</td>
                    
                      <td>Verb</td>
                    
                      <td>become</td>
                    
                      <td>돼요</td>
                    
                      <td>됐어요</td>
                    
                      <td>될 거예요</td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>것</td>
                    
                      <td>Noun</td>
                    
                      <td>THING</td>
                    
                      <td></td>
                    
                      <td></td>
                    
                      <td></td>
                    
                  </tr>
                
                  <tr>
                    
                      <td>같다</td>
                    
                      <td>Adjective</td>
                    
                      <td>similar</td>
                    
                      <td>같아요</td>
                    
                      <td>같았어요</td>
                    
                      <td>같을 거예요</td>
                    
                  </tr>
                
              </tbody>
            </table>
          </div>
          
          <!-- Screen keyboard -->
          <div id="keyboard" class="col-5 m-0 p-0 ml-4">
            <!-- Word order hint -->
            <div class="mb-3 ml-4 text-center" style="width: 495px;">
              <span class="badge badge-danger">Subject</span>
              <span class="badge badge-warning">Time</span>
              <span class="badge badge-secondary">Place</span>
              <span class="badge badge-success">Object</span>
              <span class="badge badge-info">Adverb</span>
              <span class="badge badge-primary">Verb</span>
            </div>
            
            <textarea autofocus class="ml-4" id="hangul-text" style="width: 495px; height: 215px; font-size: 30px;" onkeydown="physicalKeyboardInput();" placeholder=" Build your Korean sentence here..."></textarea>
            <div class="row m-0 p-0" style="width: 550px;">
              <div class="btn-group mt-2 mx-auto">
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary mr-1" style="width: 42px;">1</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">2</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">3</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">4</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">5</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">6</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">7</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">8</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">9</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">0</button>
              </div>
              <div class="btn-group mt-2 mx-auto">
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary mr-1">ㅃ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅉ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㄸ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㄲ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅆ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅒ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅖ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">-</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">:</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">"</button>
              </div>
              <div class="btn-group mt-2 mx-auto">
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary mr-1">ㅂ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅈ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㄷ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㄱ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅅ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅛ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅕ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅑ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅐ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅔ</button>
              </div>
              <div class="btn-group mt-2 mx-auto">
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary mr-1">ㅁ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㄴ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅇ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㄹ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅎ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅗ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅓ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅏ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅣ</button>
                      <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">!</button>
              </div>
              <div class="btn-group mt-2 mx-auto">
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary mr-1">ㅋ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅌ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅊ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅍ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅠ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅜ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1">ㅡ</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">,</button>
                <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">.</button>
                      <button onclick="screenKeyboardInput(this);" class="btn btn-outline-secondary ml-1 mr-1" style="width: 42px;">?</button>
              </div>
              <div class="btn-group mt-2 mx-auto" style="width: 500px;">
                <button onclick="screenKeyboardInput(this);" class="col btn btn-outline-secondary ml-1 mr-1">Space</button>
                <button onclick="screenKeyboardBackspace(this);" class="col btn btn-outline-secondary ml-1 mr-1">Backspace</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card-footer text-center">
        <strong>Original Korean text:</strong><br>
        내일은 오늘보다 추워질 수도 있으니까<br>옷을 따뜻하게 입어야 될 것 같아요<br>
        <hr>
        <strong>English translation:</strong><br>
        Tomorrow may be colder than today.<br>
I think you're going to have to dress warm.<br>
        <hr>
        <small>freesoft.for.people@gmail.com</small>
      </div>
    </div>
  </body>
  <script type="text/javascript">
    $('#vocabulary').dataTable({
      "bSort": false
    });
  </script>
  
  <!-- Hangul.js library -->
  <script src="https://unpkg.com/hangul-js" type="text/javascript"></script>

  <!-- Main script -->
  <script>
    const HANGUL = {
      'q': 'ㅂ',
      'w': 'ㅈ',
      'e': 'ㄷ',
      'r': 'ㄱ',
      't': 'ㅅ',
      'y': 'ㅛ',
      'u': 'ㅕ',
      'i': 'ㅑ',
      'o': 'ㅐ',
      'p': 'ㅔ',
      'a': 'ㅁ',
      's': 'ㄴ',
      'd': 'ㅇ',
      'f': 'ㄹ',
      'g': 'ㅎ',
      'h': 'ㅗ',
      'j': 'ㅓ',
      'k': 'ㅏ',
      'l': 'ㅣ',
      'z': 'ㅋ',
      'x': 'ㅌ',
      'c': 'ㅊ',
      'v': 'ㅍ',
      'b': 'ㅠ',
      'n': 'ㅜ',
      'm': 'ㅡ',
      'Q': 'ㅃ',
      'W': 'ㅉ',
      'E': 'ㄸ',
      'R': 'ㄲ',
      'T': 'ㅆ',
      'O': 'ㅒ',
      'P': 'ㅖ',
    };
    
    // always type text at cursor position
    function insertAtCursor(textArea, userInput) {
      if (textArea.selectionStart || textArea.selectionStart == '0') {
        var startPos = textArea.selectionStart;
        var endPos = textArea.selectionEnd;
        textArea.value = textArea.value.substring(0, startPos)
          + userInput
          + textArea.value.substring(endPos, textArea.value.length);
      }

      return endPos;
    }
    
    // handle user input from physical keyboard
    function physicalKeyboardInput() {
      // extract pressed key
      let key = window.event.key;
      
      // if corresponding character exists
      if (HANGUL[key] && window.event.ctrlKey == false) {
        // hack to avoid printing roman letters
        window.event.preventDefault();
        
        // extract textarea DOM element
        let text = document.getElementById('hangul-text');
        
        // input hangul characters instead of roman characters
        let pos = insertAtCursor(text, HANGUL[key]);
        
        // disassemble characters
        let parsed = Hangul.disassemble(text.value);

        // assemble characters
        text.value = Hangul.assemble(parsed);
        
        // adjust cursor position
        if (text.value.length - pos > 1)
          text.selectionEnd = text.value[pos] == ' ' ? pos : pos + 1;
      }
    }
    
    // handle user input from screen keyboard
    function screenKeyboardInput(button) {
      // extract button character
      let key = button.innerHTML.replace('Space', ' ');
      
      // extract textarea DOM element
      let text = document.getElementById('hangul-text');

      // force focus on textarea
      text.focus();
      
      // input hangul characters from screen keyboard
      let pos = insertAtCursor(text, key);

      // disassemble characters
      let parsed = Hangul.disassemble(text.value);

      // assemble characters
      text.value = Hangul.assemble(parsed);
      
      // adjust cursor position
      if (text.value.length - pos > 1)
        text.selectionEnd = (text.value[pos] == ' ' && button.innerHTML != 'Space') ? pos : pos + 1;
    }
    
    // handle backspace
    function screenKeyboardBackspace() {
      // extract textarea DOM element
      let text = document.getElementById('hangul-text');

      // force focus on textarea
      text.focus();
      
      // current cursor position
      var startPos = text.selectionStart;
      var endPos = text.selectionEnd;
        
      // erase character
      text.value = text.value = text.value.substring(0, startPos - 1) +
                                    text.value.substring(endPos, text.value.length);
      
      // adjust cursor position
      text.selectionEnd = startPos - 1;
    }
  </script>
</html>